#!/usr/bin/env python

# Copyright 2016 Ian Munsie
#
# This file is part of the Stereo Cropping Tool.
#
# The Stereo Cropping Tool is free software: you can redistribute it and/or
# modify it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# The Stereo Cropping Tool is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
# Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# The Stereo Cropping Tool. If not, see <http://www.gnu.org/licenses/>.

# http://stackoverflow.com/questions/13291783/how-to-get-the-id-memory-address-of-dll-function
# http://stackoverflow.com/questions/6165628/use-python-ctypes-to-interface-with-nvapi-follow-up-with-demonstration-code

import ctypes
from ctypes import *
from _ctypes import CFuncPtr

nvapi_ids = {
	'3D_GetProperty': 0x8061A4B1,
	'3D_GetPropertyRange': 0xB85DE27C,
	'3D_SetProperty': 0xC9175E8D,
	'Coproc_GetApplicationCoprocInfo': 0x79232685,
	'Coproc_GetCoprocInfoFlagsEx': 0x69A9874D,
	'Coproc_GetCoprocStatus': 0x1EFC3957,
	'Coproc_NotifyCoprocPowerState': 0xCADCB956,
	'Coproc_SetCoprocInfoFlagsEx': 0xF4C863AC,
	'CreateDisplayFromUnAttachedDisplay': 0x63F9799E,
	'D3D_CreateQuery': 0x5D19BCA4,
	'D3D_DestroyQuery': 0xC8FF7258,
	'D3D_GetCurrentSLIState': 0x4B708B54,
	'D3D_Query_Begin': 0xE5A9AAE0,
	'D3D_Query_End': 0x2AC084FA,
	'D3D_Query_GetData': 0xF8B53C69,
	'D3D_Query_GetDataSize': 0xF2A54796,
	'D3D_Query_GetType': 0x4ACEEAF7,
	'D3D_RegisterApp': 0xD44D3C4E,
	'D3D_SetFPSIndicatorState': 0xA776E8DB,
	'D3D10_AliasPrimaryAsTexture': 0x8AAC133D,
	'D3D10_BeginShareResource': 0x35233210,
	'D3D10_BeginShareResourceEx': 0xEF303A9D,
	'D3D10_CreateDevice': 0x2DE11D61,
	'D3D10_CreateDeviceAndSwapChain': 0x5B803DAF,
	'D3D10_EndShareResource': 0xE9C5853,
	'D3D10_GetRenderedCursorAsBitmap': 0xCAC3CE5D,
	'D3D10_ProcessCallbacks': 0xAE9C2019,
	'D3D10_SetDepthBoundsTest': 0x4EADF5D2,
	'D3D10_SetPrimaryFlipChainCallbacks': 0x73EB9329,
	'D3D11_BeginShareResource': 0x121BDC6,
	'D3D11_CreateDevice': 0x6A16D3A0,
	'D3D11_CreateDeviceAndSwapChain': 0xBB939EE5,
	'D3D11_EndShareResource': 0x8FFB8E26,
	'D3D11_SetDepthBoundsTest': 0x7AAF7A04,
	'D3D1x_BindSwapBarrier': 0x9DE8C729,
	'D3D1x_CreateSwapChain': 0x1BC21B66,
	'D3D1x_IFR_SetUpTargetBufferToSys': 0x473F7828,
	'D3D1x_IFR_TransferRenderTarget': 0x9FBAE4EB,
	'D3D1x_JoinSwapGroup': 0x14610CD7,
	'D3D1x_Present': 0x3B845A1,
	'D3D1x_QueryFrameCount': 0x9152E055,
	'D3D1x_QueryMaxSwapGroup': 0x9BB9D68F,
	'D3D1x_QuerySwapGroup': 0x407F67AA,
	'D3D1x_ResetFrameCount': 0xFBBB031A,
	'D3D9_AliasPrimaryAsTexture': 0x13C7112E,
	'D3D9_AliasPrimaryFromDevice': 0x7C20C5BE,
	'D3D9_AliasSurfaceAsTexture': 0xE5CEAE41,
	'D3D9_BindSwapBarrier': 0x9C39C246,
	'D3D9_ClearRT': 0x332D3942,
	'D3D9_CreatePathContextNV': 0xA342F682,
	'D3D9_CreatePathNV': 0x71329DF3,
	'D3D9_CreateRenderTarget': 0xB3827C8,
	'D3D9_CreateSwapChain': 0x1A131E09,
	'D3D9_CreateTexture': 0xD5E13573,
	'D3D9_CreateVideo': 0x89FFD9A3,
	'D3D9_CreateVideoBegin': 0x84C9D553,
	'D3D9_CreateVideoEnd': 0xB476BF61,
	'D3D9_DeletePathNV': 0x73E0019A,
	'D3D9_DestroyPathContextNV': 0x667C2929,
	'D3D9_DMA': 0x962B8AF6,
	'D3D9_DrawPathNV': 0x13199B3D,
	'D3D9_EnableStereo': 0x492A6954,
	'D3D9_EnumVideoFeatures': 0x1DB7C52C,
	'D3D9_FreeVideo': 0x3111BED1,
	'D3D9_GetCurrentRenderTargetHandle': 0x22CAD61,
	'D3D9_GetCurrentZBufferHandle': 0xB380F218,
	'D3D9_GetIndexBufferHandle': 0xFC5A155B,
	'D3D9_GetOverlaySurfaceHandles': 0x6800F5FC,
	'D3D9_GetSLIInfo': 0x694BFF4D,
	'D3D9_GetSurfaceHandle': 0xF2DD3F2,
	'D3D9_GetTextureHandle': 0xC7985ED5,
	'D3D9_GetVertexBufferHandle': 0x72B19155,
	'D3D9_GetVideoCapabilities': 0x3D596B93,
	'D3D9_GetVideoState': 0xA4527BF8,
	'D3D9_GPUBasedCPUSleep': 0xD504DDA7,
	'D3D9_GpuSyncAcquire': 0xD00B8317,
	'D3D9_GpuSyncEnd': 0x754033F0,
	'D3D9_GpuSyncGetHandleSize': 0x80C9FD3B,
	'D3D9_GpuSyncInit': 0x6D6FDAD4,
	'D3D9_GpuSyncMapIndexBuffer': 0x12EE68F2,
	'D3D9_GpuSyncMapSurfaceBuffer': 0x2AB714AB,
	'D3D9_GpuSyncMapTexBuffer': 0xCDE4A28A,
	'D3D9_GpuSyncMapVertexBuffer': 0xDBC803EC,
	'D3D9_GpuSyncRelease': 0x3D7A86BB,
	'D3D9_IFR_SetUpTargetBufferToNV12BLVideoSurface': 0xCFC92C15,
	'D3D9_IFR_SetUpTargetBufferToSys': 0x55255D05,
	'D3D9_IFR_TransferRenderTarget': 0xAB7C2DC,
	'D3D9_IFR_TransferRenderTargetToNV12BLVideoSurface': 0x5FE72F64,
	'D3D9_JoinSwapGroup': 0x7D44BB54,
	'D3D9_Lock': 0x6317345C,
	'D3D9_NVFBC_GetStatus': 0xBD3EB475,
	'D3D9_PathClearDepthNV': 0x157E45C4,
	'D3D9_PathDepthNV': 0xFCB16330,
	'D3D9_PathEnableColorWriteNV': 0x3E2804A2,
	'D3D9_PathEnableDepthTestNV': 0xE99BA7F3,
	'D3D9_PathMatrixNV': 0xD2F6C499,
	'D3D9_PathParameterfNV': 0xF7FF00C1,
	'D3D9_PathParameteriNV': 0xFC31236C,
	'D3D9_PathVerticesNV': 0xC23DF926,
	'D3D9_Present': 0x5650BEB,
	'D3D9_PresentSurfaceToDesktop': 0xF7029C5,
	'D3D9_PresentVideo': 0x5CF7F862,
	'D3D9_QueryAAOverrideMode': 0xDDF5643C,
	'D3D9_QueryFrameCount': 0x9083E53A,
	'D3D9_QueryMaxSwapGroup': 0x5995410D,
	'D3D9_QuerySwapGroup': 0xEBA4D232,
	'D3D9_QueryVideoInfo': 0x1E6634B3,
	'D3D9_RegisterResource': 0xA064BDFC,
	'D3D9_ResetFrameCount': 0xFA6A0675,
	'D3D9_SetGamutData': 0x2BBDA32E,
	'D3D9_SetPitchSurfaceCreation': 0x18CDF365,
	'D3D9_SetResourceHNvAPI_Status': 0x905F5C27,
	'D3D9_SetSLIMode': 0xBFDC062C,
	'D3D9_SetSurfaceCreationLayout': 0x5609B86A,
	'D3D9_SetVideoState': 0xBD4BC56F,
	'D3D9_StretchRect': 0xAEAECD41,
	'D3D9_StretchRectEx': 0x22DE03AA,
	'D3D9_Unlock': 0xC182027E,
	'D3D9_UnregisterResource': 0xBB2B17AA,
	'D3D9_VideoSetStereoInfo': 0xB852F4DB,
	'D3D9_VideoSurfaceEncryptionControl': 0x9D2509EF,
	'DeleteCustomDisplay': 0xE7CB998D,
	'DeleteUnderscanConfig': 0xF98854C8,
	'DisableHWCursor': 0xAB163097,
	'Disp_ColorControl': 0x92F9D80D,
	'Disp_DpAuxChannelControl': 0x8EB56969,
	'DISP_EnumHDMIStereoModes': 0xD2CCF5D6,
	'DISP_GetAssociatedUnAttachedNvidiaDisplayHandle': 0xA70503B2,
	'DISP_GetDisplayBlankingState': 0x63E5D8DB,
	'DISP_GetDisplayConfig': 0x11ABCCF8,
	'DISP_GetDisplayIdByDisplayName': 0xAE457190,
	'DISP_GetGDIPrimaryDisplayId': 0x1E9D8A31,
	'DISP_GetHCloneTopology': 0x47BAD137,
	'DISP_GetMonitorCapabilities': 0x3B05C7E1,
	'DISP_GetVirtualModeData': 0x3230D69A,
	'Disp_InfoFrameControl': 0x6067AF3F,
	'DISP_OverrideDisplayModeList': 0x291BFF2,
	'DISP_SetDisplayBlankingState': 0x1E17E29B,
	'DISP_SetDisplayConfig': 0x5D8CF8DE,
	'DISP_SetHCloneTopology': 0x61041C24,
	'DISP_ValidateHCloneTopology': 0x5F4C2664,
	'DRS_CreateApplication': 0x4347A9DE,
	'DRS_CreateProfile': 0xCC176068,
	'DRS_CreateSession': 0x694D52E,
	'DRS_DeleteApplication': 0x2C694BC6,
	'DRS_DeleteApplicationEx': 0xC5EA85A1,
	'DRS_DeleteProfile': 0x17093206,
	'DRS_DeleteProfileSetting': 0xE4A26362,
	'DRS_DestroySession': 0xDAD9CFF8,
	'DRS_EnumApplications': 0x7FA2173A,
	'DRS_EnumAvailableSettingIds': 0xF020614A,
	'DRS_EnumAvailableSettingValues': 0x2EC39F90,
	'DRS_EnumProfiles': 0xBC371EE0,
	'DRS_EnumSettings': 0xAE3039DA,
	'DRS_FindApplicationByName': 0xEEE566B2,
	'DRS_FindProfileByName': 0x7E4A9A0B,
	'DRS_GetApplicationInfo': 0xED1F8C69,
	'DRS_GetBaseProfile': 0xDA8466A0,
	'DRS_GetCurrentGlobalProfile': 0x617BFF9F,
	'DRS_GetNumProfiles': 0x1DAE4FBC,
	'DRS_GetProfileInfo': 0x61CD6FD6,
	'DRS_GetSetting': 0x73BF8338,
	'DRS_GetSettingIdFromName': 0xCB7309CD,
	'DRS_GetSettingNameFromId': 0xD61CBE6E,
	'DRS_LoadSettings': 0x375DBD6B,
	'DRS_LoadSettingsFromFile': 0xD3EDE889,
	'DRS_RestoreAllDefaults': 0x5927B094,
	'DRS_RestoreProfileDefault': 0xFA5F6134,
	'DRS_RestoreProfileDefaultSetting': 0x53F0381E,
	'DRS_SaveSettings': 0xFCBC7E14,
	'DRS_SaveSettingsToFile': 0x2BE25DF8,
	'DRS_SetCurrentGlobalProfile': 0x1C89C5DF,
	'DRS_SetProfileInfo': 0x16ABD3A9,
	'DRS_SetSetting': 0x577DD202,
	'EnableCurrentMosaicTopology': 0x74073CC9,
	'EnableHWCursor': 0x2863148D,
	'EnumCustomDisplay': 0x42892957,
	'EnumLogicalGPUs': 0x48B3EA59,
	'EnumNvidiaDisplayHandle': 0x9ABDD40D,
	'EnumNvidiaUnAttachedDisplayHandle': 0x20DE9260,
	'EnumPhysicalGPUs': 0xE5AC921F,
	'EnumUnderscanConfig': 0x4144111A,
	'Event_RegisterCallback': 0xE6DBEA69,
	'Event_UnregisterCallback': 0xDE1F9B45,
	'GetAssociatedDisplayOutputId': 0xD995937E,
	'GetAssociatedNvidiaDisplayHandle': 0x35C29134,
	'GetAssociatedNvidiaDisplayName': 0x22A78B05,
	'GetCurrentMosaicTopology': 0xF60852BD,
	'GetDisplayDriverMemoryInfo': 0x774AA982,
	'GetDisplayDriverVersion': 0xF951A4D1,
	'GetDisplayFeatureConfig': 0x8E985CCD,
	'GetDisplayFeatureConfigDefaults': 0xF5F4D01,
	'GetDisplayPortInfo': 0xC64FF367,
	'GetDisplayPosition': 0x6BB1EE5D,
	'GetDisplaySettings': 0xDC27D5D4,
	'GetDriverMemoryInfo': 0x2DC95125,
	'GetDVCInfo': 0x4085DE45,
	'GetDVCInfoEx': 0xE45002D,
	'GetErrorMessage': 0x6C2D048C,
	'GetHDCPLinkParameters': 0xB3BB0772,
	'GetHDMISupportInfo': 0x6AE16EC3,
	'GetHUEInfo': 0x95B64341,
	'GetHybridMode': 0xE23B68C1,
	'GetImageSharpeningInfo': 0x9FB063DF,
	'GetInfoFrame': 0x9734F1D,
	'GetInfoFrameState': 0x41511594,
	'GetInvalidGpuTopologies': 0x15658BE6,
	'GetLogicalGPUFromDisplay': 0xEE1370CF,
	'GetLogicalGPUFromPhysicalGPU': 0xADD604D1,
	'GetNvAPI_StatuserfaceVersionString': 0x1053FA5,
	'GetPhysicalGPUFromUnAttachedDisplay': 0x5018ED61,
	'GetPhysicalGPUsFromDisplay': 0x34EF9506,
	'GetPhysicalGPUsFromLogicalGPU': 0xAEA3FA32,
	'GetPVExtName': 0x2F5B08E0,
	'GetPVExtProfile': 0x1B1B9A16,
	'GetSupportedMosaicTopologies': 0x410B5C25,
	'GetSupportedViews': 0x66FB7FC0,
	'GetTiming': 0xAFC4833E,
	'GetTVEncoderControls': 0x5757474A,
	'GetTVOutputBorderColor': 0x6DFD1C8C,
	'GetTVOutputInfo': 0x30C805D5,
	'GetUnAttachedAssociatedDisplayName': 0x4888D790,
	'GetValidGpuTopologies': 0x5DFAB48A,
	'GetVBlankCounter': 0x67B5DB55,
	'GetVideoState': 0x1C5659CD,
	'GetView': 0xD6B99D89,
	'GetViewEx': 0xDBBC0AF4,
	'GPS_GetPerfSensors': 0x271C1109,
	'GPS_GetPowerSteeringStatus': 0x540EE82E,
	'GPS_GetThermalLimit': 0x583113ED,
	'GPS_GetVPStateCap': 0x71913023,
	'GPS_SetPowerSteeringStatus': 0x9723D3A2,
	'GPS_SetThermalLimit': 0xC07E210F,
	'GPS_SetVPStateCap': 0x68888EB4,
	'GPU_ClientPowerPoliciesGetInfo': 0x34206D86,
	'GPU_ClientPowerPoliciesGetStatus': 0x70916171,
	'GPU_ClientPowerPoliciesSetStatus': 0xAD95F5ED,
	'GPU_ClientPowerTopologyGetInfo': 0xA4DFD3F2,
	'GPU_ClientPowerTopologyGetStatus': 0xEDCF624E,
	'GPU_EnableDynamicPstates': 0xFA579A0F,
	'GPU_EnableOverclockedPstates': 0xB23B70EE,
	'GPU_Get_DisplayPort_DongleInfo': 0x76A70E8D,
	'GPU_GetActiveOutputs': 0xE3E89B6F,
	'GPU_GetAGPAperture': 0x6E042794,
	'GPU_GetAllClockFrequencies': 0xDCB616C3,
	'GPU_GetAllDisplayIds': 0x785210A2,
	'GPU_GetAllOutputs': 0x7D554F8E,
	'GPU_GetBoardInfo': 0x22D54523,
	'GPU_GetBusId': 0x1BE0B8E5,
	'GPU_GetBusSlotId': 0x2A0A350F,
	'GPU_GetBusType': 0x1BB18724,
	'GPU_GetColorSpaceConversion': 0x8159E87A,
	'GPU_GetConnectedDisplayIds': 0x78DBA2,
	'GPU_GetConnectedOutputs': 0x1730BFC9,
	'GPU_GetConnectedOutputsWithLidState': 0xCF8CAF39,
	'GPU_GetConnectedSLIOutputs': 0x680DE09,
	'GPU_GetConnectedSLIOutputsWithLidState': 0x96043CC7,
	'GPU_GetConnectorInfo': 0x4ECA2C10,
	'GPU_GetCoolerPolicyTable': 0x518A32C,
	'GPU_GetCoolerSettings': 0xDA141340,
	'GPU_GetCurrentAGPRate': 0xC74925A0,
	'GPU_GetCurrentFanSpeedLevel': 0xBD71F0C9,
	'GPU_GetCurrentPCIEDownstreamWidth': 0xD048C3B1,
	'GPU_GetCurrentPstate': 0x927DA4F6,
	'GPU_GetCurrentThermalLevel': 0xD2488B79,
	'GPU_GetDeviceDisplayMode': 0xD2277E3A,
	'GPU_GetDitherControl': 0x932AC8FB,
	'GPU_GetDynamicPstatesInfoEx': 0x60DED2ED,
	'GPU_GetECCConfigurationInfo': 0x77A796F3,
	'GPU_GetECCErrorInfo': 0xC71F85A6,
	'GPU_GetECCStatusInfo': 0xCA1DDAF3,
	'GPU_GetEDID': 0x37D32E69,
	'GPU_GetFBWidthAndLocation': 0x11104158,
	'GPU_GetFlatPanelInfo': 0x36CFF969,
	'GPU_GetFullName': 0xCEEE8E9F,
	'GPU_GetGpuCoreCount': 0xC7026A87,
	'GPU_GetGPUType': 0xC33BAEB1,
	'GPU_GetHDCPSupportStatus': 0xF089EEF5,
	'GPU_GetIllumination': 0x9A1B9365,
	'GPU_GetIRQ': 0xE4715417,
	'GPU_GetMemPartitionMask': 0x329D77CD,
	'GPU_GetOutputType': 0x40A505E4,
	'GPU_GetPartitionCount': 0x86F05D7A,
	'GPU_GetPCIIdentifiers': 0x2DDFB66E,
	'GPU_GetPerfClocks': 0x1EA54A3B,
	'GPU_GetPerfDecreaseInfo': 0x7F7F4600,
	'GPU_GetPerGpuTopologyStatus': 0xA81F8992,
	'GPU_GetPhysicalFrameBufferSize': 0x46FBEB03,
	'GPU_GetPixelClockRange': 0x66AF10B7,
	'GPU_GetPowerMizerInfo': 0x76BFA16B,
	'GPU_GetPstateClientLimits': 0x88C82104,
	'GPU_GetPstates20': 0x6FF81213,
	'GPU_GetPstatesInfo': 0xBA94C56E,
	'GPU_GetPstatesInfoEx': 0x843C0256,
	'GPU_GetQuadroStatus': 0xE332FA47,
	'GPU_GetRamType': 0x57F7CAAC,
	'GPU_GetScanoutConfiguration': 0x6A9F5B63,
	'GPU_GetShaderPipeCount': 0x63E2F56F,
	'GPU_GetShaderSubPipeCount': 0xBE17923,
	'GPU_GetSMMask': 0xEB7AF173,
	'GPU_GetSystemType': 0xBAAABFCC,
	'GPU_GetTachReading': 0x5F608315,
	'GPU_GetThermalSettings': 0xE3640A56,
	'GPU_GetTotalSMCount': 0xAE5FBCFE,
	'GPU_GetTotalSPCount': 0xB6D62591,
	'GPU_GetTotalTPCCount': 0x4E2F76A8,
	'GPU_GetTPCMask': 0x4A35DF54,
	'GPU_GetVbiosOEMRevision': 0x2D43FB31,
	'GPU_GetVbiosRevision': 0xACC3DA0A,
	'GPU_GetVbiosVersionString': 0xA561FD7D,
	'GPU_GetVirtualFrameBufferSize': 0x5A04B644,
	'GPU_GetVoltageDomainsStatus': 0xC16C7E2C,
	'GPU_GetVoltages': 0x7D656244,
	'GPU_GPIOQueryLegalPins': 0xFAB69565,
	'GPU_GPIOReadFromPin': 0xF5E10439,
	'GPU_GPIOWriteToPin': 0xF3B11E68,
	'GPU_QueryActiveApps': 0x65B1C5F5,
	'GPU_QueryIlluminationSupport': 0xA629DA31,
	'GPU_ResetECCErrorInfo': 0xC02EEC20,
	'GPU_RestoreCoolerPolicyTable': 0xD8C4FE63,
	'GPU_RestoreCoolerSettings': 0x8F6ED0FB,
	'GPU_SetColorSpaceConversion': 0xFCABD23A,
	'GPU_SetCoolerLevels': 0x891FA0AE,
	'GPU_SetCoolerPolicyTable': 0x987947CD,
	'GPU_SetDitherControl': 0xDF0DFCDD,
	'GPU_SetECCConfiguration': 0x1CF639D9,
	'GPU_SetEDID': 0xE83D6456,
	'GPU_SetIllumination': 0x254A187,
	'GPU_SetPerfClocks': 0x7BCF4AC,
	'GPU_SetPixelClockRange': 0x5AC7F8E5,
	'GPU_SetPowerMizerInfo': 0x50016C78,
	'GPU_SetPstateClientLimits': 0xFDFC7D49,
	'GPU_SetPstates20': 0xF4DAE6B,
	'GPU_SetPstatesInfo': 0xCDF27911,
	'GPU_SetScanoutNvAPI_Statusensity': 0xA57457A4,
	'GPU_SetScanoutWarping': 0xB34BAB4F,
	'GPU_ValidateOutputCombination': 0x34C9C2D4,
	'GPU_WorkstationFeatureQuery': 0x4537DF,
	'GPU_WorkstationFeatureSetup': 0x6C1F3FE4,
	'Hybrid_IsAppMigrationStateChangeable': 0x584CB0B6,
	'Hybrid_QueryBlockedMigratableApps': 0xF4C2F8CC,
	'Hybrid_QueryUnblockedNonMigratableApps': 0x5F35BCB5,
	'Hybrid_SetAppMigrationState': 0xFA0B9A59,
	'I2CRead': 0x2FDE12C5,
	'I2CReadEx': 0x4D7B0709,
	'I2CWrite': 0xE812EB07,
	'I2CWriteEx': 0x283AC65A,
	'Initialize': 0x150E828,
	'Mosaic_ChooseGpuTopologies': 0xB033B140,
	'Mosaic_EnableCurrentTopo': 0x5F1AA66C,
	'Mosaic_EnumDisplayGrids': 0xDF2887AF,
	'Mosaic_EnumDisplayModes': 0x78DB97D7,
	'Mosaic_EnumGridTopologies': 0xA3C55220,
	'Mosaic_GetCurrentTopo': 0xEC32944E,
	'Mosaic_GetDisplayCapabilities': 0xD58026B9,
	'Mosaic_GetDisplayViewportsByResolution': 0xDC6DC8D3,
	'Mosaic_GetMosaicCapabilities': 0xDA97071E,
	'Mosaic_GetMosaicViewports': 0x7EBA036,
	'Mosaic_GetOverlapLimits': 0x989685F0,
	'Mosaic_GetSupportedTopoInfo': 0xFDB63C81,
	'Mosaic_GetTopoGroup': 0xCB89381D,
	'Mosaic_SetCurrentTopo': 0x9B542831,
	'Mosaic_SetDisplayGrids': 0x4D959A89,
	'Mosaic_SetGridTopology': 0x3F113C77,
	'Mosaic_ValidateDisplayGrids': 0xCF43903D,
	'Mosaic_ValidateDisplayGridsWithSLI': 0x1ECFD263,
	'OGL_ExpertModeDefaultsGet': 0xAE921F12,
	'OGL_ExpertModeDefaultsSet': 0xB47A657E,
	'OGL_ExpertModeGet': 0x22ED9516,
	'OGL_ExpertModeSet': 0x3805EF7A,
	'QueryNonMigratableApps': 0xBB9EF1C3,
	'QueryUnderscanCap': 0x61D7B624,
	'RevertCustomDisplayTrial': 0x854BA405,
	'SaveCustomDisplay': 0xA9062C78,
	'SetCurrentMosaicTopology': 0xD54B8989,
	'SetDisplayFeatureConfig': 0xF36A668D,
	'SetDisplayPort': 0xFA13E65A,
	'SetDisplayPosition': 0x57D9060F,
	'SetDisplaySettings': 0xE04F3D86,
	'SetDVCLevel': 0x172409B4,
	'SetDVCLevelEx': 0x4A82C2B1,
	'SetFrameRateNotify': 0x18919887,
	'SetGpuTopologies': 0x25201F3D,
	'SetHUEAngle': 0xF5A0F22C,
	'SetHybridMode': 0xFB22D656,
	'SetImageSharpeningLevel': 0x3FC9A59C,
	'SetInfoFrame': 0x69C6F365,
	'SetInfoFrameState': 0x67EFD887,
	'SetPVExtName': 0x4FEEB498,
	'SetPVExtProfile': 0x8354A8F4,
	'SetRefreshRateOverride': 0x3092AC32,
	'SetTopologyFocusDisplayAndView': 0xA8064F9,
	'SetTVEncoderControls': 0xCA36A3AB,
	'SetTVOutputBorderColor': 0xAED02700,
	'SetUnderscanConfig': 0x3EFADA1D,
	'SetVideoState': 0x54FE75A,
	'SetView': 0x957D7B6,
	'SetViewEx': 0x6B89E68,
	'Stereo_Activate': 0xF6A1AD68,
	'Stereo_AppHandShake': 0x8C610BDA,
	'Stereo_CaptureJpegImage': 0x932CB140,
	'Stereo_CapturePngImage': 0x8B7E99B5,
	'Stereo_CreateConfigurationProfileRegistryKey': 0xBE7692EC,
	'Stereo_CreateHandleFromIUnknown': 0xAC7E37F4,
	'Stereo_Deactivate': 0x2D68DE96,
	'Stereo_Debug_WasLastDrawStereoized': 0xED4416C5,
	'Stereo_DecreaseConvergence': 0x4C87E317,
	'Stereo_DecreaseSeparation': 0xDA044458,
	'Stereo_DeleteConfigurationProfileRegistryKey': 0xF117B834,
	'Stereo_DeleteConfigurationProfileValue': 0x49BCEECF,
	'Stereo_DestroyHandle': 0x3A153134,
	'Stereo_Disable': 0x2EC50C2B,
	'Stereo_Enable': 0x239C4545,
	'Stereo_ForceToScreenDepth': 0x2D495758,
	'Stereo_GetConvergence': 0x4AB00934,
	'Stereo_GetCursorSeparation': 0x72162B35,
	'Stereo_GetDefaultProfile': 0x624E21C2,
	'Stereo_GetEyeSeparation': 0xCE653127,
	'Stereo_GetFrustumAdjustMode': 0xE6839B43,
	'Stereo_GetPixelShaderConstantB': 0xC79333AE,
	'Stereo_GetPixelShaderConstantF': 0xD4974572,
	'Stereo_GetPixelShaderConstantI': 0xECD8F8CF,
	'Stereo_GetSeparation': 0x451F2134,
	'Stereo_GetStereoCaps': 0xDFC063B7,
	'Stereo_GetStereoSupport': 0x296C434D,
	'Stereo_GetSurfaceCreationMode': 0x36F1C736,
	'Stereo_GetVertexShaderConstantB': 0x712BAA5B,
	'Stereo_GetVertexShaderConstantF': 0x622FDC87,
	'Stereo_GetVertexShaderConstantI': 0x5A60613A,
	'Stereo_HandShake_Message_Control': 0x315E0EF0,
	'Stereo_HandShake_Trigger_Activation': 0xB30CD1A7,
	'Stereo_IncreaseConvergence': 0xA17DAABE,
	'Stereo_IncreaseSeparation': 0xC9A8ECEC,
	'Stereo_InitActivation': 0xC7177702,
	'Stereo_Is3DCursorSupported': 0xD7C9EC09,
	'Stereo_IsActivated': 0x1FB0BC30,
	'Stereo_IsEnabled': 0x348FF8E1,
	'Stereo_IsWindowedModeSupported': 0x40C8ED5E,
	'Stereo_ReverseStereoBlitControl': 0x3CD58F89,
	'Stereo_SetActiveEye': 0x96EEA9F8,
	'Stereo_SetConfigurationProfileValue': 0x24409F48,
	'Stereo_SetConvergence': 0x3DD6B54B,
	'Stereo_SetCursorSeparation': 0xFBC08FC1,
	'Stereo_SetDefaultProfile': 0x44F0ECD1,
	'Stereo_SetDriverMode': 0x5E8F0BEC,
	'Stereo_SetFrustumAdjustMode': 0x7BE27FA2,
	'Stereo_SetNotificationMessage': 0x6B9B409E,
	'Stereo_SetPixelShaderConstantB': 0xBA6109EE,
	'Stereo_SetPixelShaderConstantF': 0xA9657F32,
	'Stereo_SetPixelShaderConstantI': 0x912AC28F,
	'Stereo_SetSeparation': 0x5C069FA3,
	'Stereo_SetSurfaceCreationMode': 0xF5DCFCBA,
	'Stereo_SetVertexShaderConstantB': 0x5268716F,
	'Stereo_SetVertexShaderConstantF': 0x416C07B3,
	'Stereo_SetVertexShaderConstantI': 0x7923BA0E,
	'Stereo_Trigger_Activation': 0xD6C6CD2,
	'SYS_GetChipSetInfo': 0x53DABBCA,
	'SYS_GetChipSetTopologyStatus': 0x8A50F126,
	'SYS_GetDisplayIdFromGpuAndOutputId': 0x8F2BAB4,
	'SYS_GetDriverAndBranchVersion': 0x2926AAAD,
	'SYS_GetGpuAndOutputIdFromDisplayId': 0x112BA1A5,
	'SYS_GetLidAndDockInfo': 0xCDA14D8A,
	'SYS_VenturaGetCoolingBudget': 0xC9D86E33,
	'SYS_VenturaGetPowerReading': 0x63685979,
	'SYS_VenturaGetState': 0xCB7C208D,
	'SYS_VenturaSetCoolingBudget': 0x85FF5A15,
	'SYS_VenturaSetState': 0xCE2E9D9,
	'TryCustomDisplay': 0xBF6C1762,
	'Unload': 0xD22BDD7E,
	'VideoGetStereoInfo': 0x8E1F8CFE,
	'VideoSetStereoInfo': 0x97063269,
	'VIO_Close': 0xD01BD237,
	'VIO_EnumDataFormats': 0x221FA8E8,
	'VIO_EnumDevices': 0xFD7C5557,
	'VIO_EnumSignalFormats': 0xEAD72FE4,
	'VIO_GetCapabilities': 0x1DC91303,
	'VIO_GetConfig': 0xD34A789B,
	'VIO_GetCSC': 0x7B0D72A3,
	'VIO_GetGamma': 0x51D53D06,
	'VIO_GetPCIInfo': 0xB981D935,
	'VIO_GetSyncDelay': 0x462214A9,
	'VIO_IsFrameLockModeCompatible': 0x7BF0A94D,
	'VIO_IsRunning': 0x96BD040E,
	'VIO_Open': 0x44EE4841,
	'VIO_QueryTopology': 0x869534E2,
	'VIO_SetConfig': 0xE4EEC07,
	'VIO_SetCSC': 0xA1EC8D74,
	'VIO_SetGamma': 0x964BF452,
	'VIO_SetSyncDelay': 0x2697A8D1,
	'VIO_Start': 0xCDE8E1A3,
	'VIO_Status': 0xE6CE4F1,
	'VIO_Stop': 0x6BA2A5D6,
	'VIO_SyncFormatDetect': 0x118D48A3,
}

class NvAPI_Exception(Exception): pass

NvAPI_UnicodeString = c_uint16 * 2048

class STEREO_DRIVER_MODE(object):
	AUTOMATIC = 0
	DIRECT    = 2

class STEREO_ACTIVE_EYE(object):
	RIGHT = 1
	LEFT  = 2
	MONO  = 3

class NVDRS_SETTING(Structure):
	class VALUE(Union):
		class BinaryValue(Structure):
			_fields_ = [
				('valueLength', c_uint32),
				('valueData', c_uint8 * 4096),
			]
		_fields_ = [
			('u32Value', c_uint32),
			('binaryValue', BinaryValue),
			('wszValue', NvAPI_UnicodeString),
		]
	_fields_ = [
		('version', c_uint32),
		('settingName', NvAPI_UnicodeString),
		('settingId', c_uint32),
		('settingType', c_int),
		('settingLocation', c_int),
		('isCurrentPredefined', c_uint32),
		('isPredefinedValid', c_uint32),
		('predefined', VALUE),
		('current', VALUE),
	]

def MAKE_NVAPI_VERSION(struct, version):
	return sizeof(struct) | (version << 16)

class _NvAPI(object):
	nvapi_QueryInterface = cdll.nvapi.nvapi_QueryInterface

	class _nvapi_FuncPtr(CFuncPtr):
		_flags_ = ctypes._FUNCFLAG_CDECL
		_restype_ = c_int

	def get_error(self, status):
		szDesc = create_string_buffer(64)
		self.GetErrorMessage(status, szDesc)
		return szDesc

	def wrap_errors(self, fn):
		def f(*a, **kw):
			rc = fn(*a, **kw)
			if (rc):
				err = self.get_error(rc)
				raise NvAPI_Exception(err.value)
			return rc
		return f

	def __getattr__(self, name):
		id = nvapi_ids[name]
		ptr = self.nvapi_QueryInterface(id)
		f = self.wrap_errors(self._nvapi_FuncPtr(ptr))
		setattr(self, name, f)
		return f

NvAPI = _NvAPI()
